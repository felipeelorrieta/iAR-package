<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Maximum Likelihood Estimation of Parameters for iAR, CiAR, and BiAR Models using the Kalman Filter — kalman • iAR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Maximum Likelihood Estimation of Parameters for iAR, CiAR, and BiAR Models using the Kalman Filter — kalman"><meta name="description" content="Performs Maximum Likelihood Estimation (MLE) of the parameters of the iAR, CiAR, and BiAR models by maximizing the likelihood function using the Kalman filter.
This method applies the Kalman filter to compute the likelihood and estimate the model parameters that maximize the likelihood for each model type."><meta property="og:description" content="Performs Maximum Likelihood Estimation (MLE) of the parameters of the iAR, CiAR, and BiAR models by maximizing the likelihood function using the Kalman filter.
This method applies the Kalman filter to compute the likelihood and estimate the model parameters that maximize the likelihood for each model type."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">iAR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://felipeelorrieta.github.io/">Home page</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Maximum Likelihood Estimation of Parameters for iAR, CiAR, and BiAR Models using the Kalman Filter</h1>

      <div class="d-none name"><code>kalman.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs Maximum Likelihood Estimation (MLE) of the parameters of the iAR, CiAR, and BiAR models by maximizing the likelihood function using the Kalman filter.
This method applies the Kalman filter to compute the likelihood and estimate the model parameters that maximize the likelihood for each model type.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">kalman</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code> containing the model specification and parameters:</p><ul><li><p>For <code>iAR</code> models, the object should contain:</p><ul><li><p><code>series</code>: A numeric vector of the time series data.</p></li>
<li><p><code>times</code>: A numeric vector specifying the time points of the series.</p></li>
<li><p><code>series_esd</code>: A numeric vector specifying the error structure.</p></li>
<li><p><code>zero_mean</code>: A logical value indicating if the series should be zero-centered.</p></li>
<li><p><code>standardized</code>: A logical value indicating if the series should be standardized.</p></li>
</ul></li>
<li><p>For <code>CiAR</code> models, the object should contain:</p><ul><li><p><code>series</code>: A numeric vector of the time series data.</p></li>
<li><p><code>times</code>: A numeric vector specifying the time points of the series.</p></li>
<li><p><code>series_esd</code>: A numeric vector specifying the error structure.</p></li>
<li><p><code>zero_mean</code>: A logical value indicating if the series should be zero-centered.</p></li>
<li><p><code>standardized</code>: A logical value indicating if the series should be standardized.</p></li>
<li><p><code>c</code>: A numeric value specifying the scale parameter for the CiAR model.</p></li>
<li><p><code>niter</code>: An integer specifying the number of iterations for the Kalman filter.</p></li>
<li><p><code>seed</code>: An integer seed for random number generation (optional).</p></li>
</ul></li>
<li><p>For <code>BiAR</code> models, the object should contain:</p><ul><li><p><code>series</code>: A numeric matrix containing two columns for bivariate time series data.</p></li>
<li><p><code>times</code>: A numeric vector specifying the time points of the series.</p></li>
<li><p><code>series_esd</code>: A numeric matrix specifying the error structure for both series.</p></li>
<li><p><code>zero_mean</code>: A logical value indicating if the series should be zero-centered.</p></li>
<li><p><code>niter</code>: An integer specifying the number of iterations for the Kalman filter.</p></li>
<li><p><code>seed</code>: An integer seed for random number generation (optional).</p></li>
</ul></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments (unused).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An updated object of class <code>iAR</code>, <code>CiAR</code>, or <code>BiAR</code>, where the <code>coef</code> property is updated with the estimated model parameters (using MLE) and the <code>kalmanlik</code> property contains the log-likelihood value of the model.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function applies the Kalman filter to perform Maximum Likelihood Estimation (MLE) of the parameters of the autoregressive models (iAR, CiAR, BiAR). The Kalman filter is used to maximize the likelihood function based on the given time series data, and the parameters that maximize the likelihood are estimated.</p>
<p>- For <code>iAR</code>, the Kalman filter is applied to estimate the model parameters by maximizing the likelihood.
- For <code>CiAR</code>, the Kalman filter is applied to estimate the parameters of the complex autoregressive model by maximizing the likelihood.
- For <code>BiAR</code>, the Kalman filter is applied to estimate the parameters of the bivariate autoregressive model by maximizing the likelihood.</p>
<p>The method returns the updated model object, including the estimated parameters and the log-likelihood value.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Eyheramendy S, Elorrieta F, Palma W (2018).
“An irregular discrete time series model to identify residuals with autocorrelation in astronomical light curves.”
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>481</b>(4), 4311-4322.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/sty2487" class="external-link">doi:10.1093/mnras/sty2487</a>
, https://academic.oup.com/mnras/article-pdf/481/4/4311/25906473/sty2487.pdf.
,Elorrieta, F, Eyheramendy, S, Palma, W (2019).
“Discrete-time autoregressive model for unequally spaced time-series observations.”
<em>A&amp;A</em>, <b>627</b>, A120.
<a href="https://doi.org/10.1051/0004-6361/201935560" class="external-link">doi:10.1051/0004-6361/201935560</a>
.
,Elorrieta F, Eyheramendy S, Palma W, Ojeda C (2021).
“A novel bivariate autoregressive model for predicting and forecasting irregularly observed time series.”
<em>Monthly Notices of the Royal Astronomical Society</em>, <b>505</b>(1), 1105-1116.
ISSN 0035-8711, <a href="https://doi.org/10.1093/mnras/stab1216" class="external-link">doi:10.1093/mnras/stab1216</a>
, https://academic.oup.com/mnras/article-pdf/505/1/1105/38391762/stab1216.pdf.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Applying Kalman filter for MLE of iAR model parameters</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://felipeelorrieta.github.io/iAR-package/">iAR</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">100</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">6714</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">o</span><span class="op">=</span><span class="fu">iAR</span><span class="fu">::</span><span class="fu"><a href="utilities.html">utilities</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">o</span><span class="op">&lt;-</span><span class="fu"><a href="gentime.html">gentime</a></span><span class="op">(</span><span class="va">o</span>, n<span class="op">=</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">times</span><span class="op">=</span><span class="va">o</span><span class="op">@</span><span class="va">times</span></span></span>
<span class="r-in"><span><span class="va">model_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="iAR.html">iAR</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"norm"</span>, times <span class="op">=</span> <span class="va">times</span>, coef <span class="op">=</span> <span class="fl">0.9</span>,hessian<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_norm</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">model_norm</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_norm</span> <span class="op">&lt;-</span> <span class="fu">kalman</span><span class="op">(</span><span class="va">model_norm</span><span class="op">)</span>  </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model_norm</span><span class="op">@</span><span class="va">coef</span><span class="op">)</span>  <span class="co"># Access the estimated coefficients</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9088109</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model_norm</span><span class="op">@</span><span class="va">kalmanlik</span><span class="op">)</span>  <span class="co"># Access the Kalman likelihood value</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2431375</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Applying Kalman filter for MLE of CiAR model parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">6714</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_CiAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="CiAR.html">CiAR</a></span><span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>,coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_CiAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">model_CiAR</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">=</span><span class="va">model_CiAR</span><span class="op">@</span><span class="va">series</span></span></span>
<span class="r-in"><span><span class="va">y1</span><span class="op">=</span><span class="va">y</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_CiAR</span><span class="op">@</span><span class="va">series</span><span class="op">=</span><span class="va">y1</span></span></span>
<span class="r-in"><span><span class="va">model_CiAR</span><span class="op">@</span><span class="va">series_esd</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_CiAR</span> <span class="op">&lt;-</span> <span class="fu">kalman</span><span class="op">(</span><span class="va">model_CiAR</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model_CiAR</span><span class="op">@</span><span class="va">coef</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.9199923 -0.1072453</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model_CiAR</span><span class="op">@</span><span class="va">kalmanlik</span><span class="op">)</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2272269</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Applying Kalman filter for MLE of BiAR model parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">6714</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_BiAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="BiAR.html">BiAR</a></span><span class="op">(</span>times <span class="op">=</span> <span class="va">times</span>,coef <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.3</span><span class="op">)</span>, rho <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_BiAR</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim.html">sim</a></span><span class="op">(</span><span class="va">model_BiAR</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span><span class="op">=</span><span class="va">model_BiAR</span><span class="op">@</span><span class="va">series</span></span></span>
<span class="r-in"><span><span class="va">y1</span><span class="op">=</span><span class="va">y</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">y</span>,<span class="fl">2</span>,<span class="va">sd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_BiAR</span><span class="op">@</span><span class="va">series</span><span class="op">=</span><span class="va">y1</span></span></span>
<span class="r-in"><span><span class="va">model_BiAR</span><span class="op">@</span><span class="va">series_esd</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">n</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_BiAR</span> <span class="op">&lt;-</span> <span class="fu">kalman</span><span class="op">(</span><span class="va">model_BiAR</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model_BiAR</span><span class="op">@</span><span class="va">coef</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8997529 0.3154864</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model_BiAR</span><span class="op">@</span><span class="va">kalmanlik</span><span class="op">)</span>  </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -27.07637</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Elorrieta Felipe, Ojeda Cesar, Eyheramendy Susana, Palma Wilfredo.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

